<!-- business-list.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Business List - ShopFinder</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <h1>All Businesses</h1>
    <nav>
      <a href="index.html">Home</a>
      <a href="add-business.html">Add Business</a>
    </nav>
  </header>
  <main>
    <input type="text" id="searchInput" placeholder="Search by name or category...">
    <div id="businessList"></div>
    <div class="pagination" id="pagination"></div>
  </main>
  <script>
    const listContainer = document.getElementById("businessList");
    const searchInput = document.getElementById("searchInput");
    const pagination = document.getElementById("pagination");

    const ITEMS_PER_PAGE = 5;
    let currentPage = 1;

    function renderBusinesses(filter = "", page = 1) {
      const businesses = JSON.parse(localStorage.getItem("businesses") || "[]");
      const filtered = businesses.filter(b =>
        b.name.toLowerCase().includes(filter.toLowerCase()) ||
        b.category.toLowerCase().includes(filter.toLowerCase())
      );

      const totalPages = Math.ceil(filtered.length / ITEMS_PER_PAGE);
      const start = (page - 1) * ITEMS_PER_PAGE;
      const paginatedItems = filtered.slice(start, start + ITEMS_PER_PAGE);

      listContainer.innerHTML = "";
      if (paginatedItems.length === 0) {
        listContainer.innerHTML = "<p>No businesses found.</p>";
        pagination.innerHTML = "";
        return;
      }

      paginatedItems.forEach(b => {
        const div = document.createElement("div");
        div.classList.add("business-card");
        div.innerHTML = `
          <h3>${b.name}</h3>
          <p><strong>Category:</strong> ${b.category}</p>
          <p>${b.description}</p>
        `;
        listContainer.appendChild(div);
      });

      renderPagination(totalPages, page);
    }

    function renderPagination(total, current) {
      pagination.innerHTML = "";
      for (let i = 1; i <= total; i++) {
        const btn = document.createElement("button");
        btn.textContent = i;
        if (i === current) btn.disabled = true;
        btn.addEventListener("click", () => {
          currentPage = i;
          renderBusinesses(searchInput.value, currentPage);
        });
        pagination.appendChild(btn);
      }
    }

    searchInput.addEventListener("input", () => {
      currentPage = 1;
      renderBusinesses(searchInput.value, currentPage);
    });

    renderBusinesses();
  </script>
</body>
</html>
